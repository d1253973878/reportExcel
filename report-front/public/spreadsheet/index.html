<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>x-spreadsheet</title>
    <style>
      body,
      html {
        height: 100%;
        padding: 0;
        margin: 0;
      }

      #x-spreadsheet-demo1 {
        width: 100%;
        height: 100%;
      }

      #x-spreadsheet-demo2 {
        width: 100%;
        height: 15%;
        color: #fff;
        text-align: center;
      }

      #test {
        margin-left: 100px;
        width: 50px;
        height: 25px;
        background: red;
      }

      /* #x-spreadsheet-demo1,
      #x-spreadsheet-demo2 {
        width: calc(50% - 10px);
        height: 100%;
        float: left;
      } */
    </style>
  <link href="xspreadsheet.css" rel="stylesheet"></head>

  <body onload="load()">
    <div id="x-spreadsheet-demo1"></div>
    <!-- <div id="x-spreadsheet-demo2">
      <div id="test" draggable="true">aaaa</div>
    </div> -->
    <!--script type="text/javascript" src="https://unpkg.com/x-data-spreadsheet@1.0.20/dist/locale/zh-cn.js"></script-->
  <script type="text/javascript" src="xspreadsheet.js"></script></body>
  <script>
    const SHEET_DATA = [
      {
        area: { eci: 3, sri: 5, sci: 3, width: 100, eri: 5, height: 25 },
        printArea: {
          col: 9,
          scrollHeight: 0,
          type: "Letter",
          width: 979,
          row: 23,
          height: 600,
          scrollWidth: 0,
        },
        rows: {
          0: {
            cells: {
              0: { virtual: "JhtSPmXlov0deCvi", style: 2 },
              1: { virtual: "JhtSPmXlov0deCvi", style: 2 },
              2: { virtual: "JhtSPmXlov0deCvi", style: 1 },
              3: { virtual: "JhtSPmXlov0deCvi", style: 1 },
              4: { virtual: "JhtSPmXlov0deCvi", style: 1 },
              5: { virtual: "dQ4a6sLadYXe2tOj", style: 1 },
              6: { virtual: "dQ4a6sLadYXe2tOj", style: 1 },
              7: { virtual: "dQ4a6sLadYXe2tOj", style: 1 },
              8: { virtual: "dQ4a6sLadYXe2tOj", style: 1 },
              9: { virtual: "dQ4a6sLadYXe2tOj", text: " " },
            },
          },
          1: {
            cells: {
              0: { virtual: "JhtSPmXlov0deCvi", style: 1 },
              1: { virtual: "JhtSPmXlov0deCvi", style: 1 },
              2: { virtual: "JhtSPmXlov0deCvi", style: 1 },
              3: { virtual: "JhtSPmXlov0deCvi", style: 1 },
              4: { virtual: "JhtSPmXlov0deCvi", style: 1 },
              5: { style: 1 },
              6: { virtual: "dQ4a6sLadYXe2tOj", style: 1 },
              7: { virtual: "dQ4a6sLadYXe2tOj", style: 1 },
              8: { virtual: "dQ4a6sLadYXe2tOj", style: 1 },
              9: { virtual: "dQ4a6sLadYXe2tOj", text: " " },
              10: { virtual: "dQ4a6sLadYXe2tOj", text: " " },
            },
          },
          2: {
            cells: {
              0: { virtual: "JhtSPmXlov0deCvi", style: 1 },
              1: { virtual: "JhtSPmXlov0deCvi", style: 1 },
              2: { virtual: "JhtSPmXlov0deCvi", style: 3, text: "星期" },
              3: { virtual: "JhtSPmXlov0deCvi", style: 3, text: "价格" },
              4: { virtual: "JhtSPmXlov0deCvi", style: 1 },
              5: { virtual: "dQ4a6sLadYXe2tOj", style: 1 },
              6: { virtual: "dQ4a6sLadYXe2tOj", style: 1 },
              7: { virtual: "dQ4a6sLadYXe2tOj", style: 1 },
              8: { virtual: "dQ4a6sLadYXe2tOj", style: 1 },
              9: { virtual: "dQ4a6sLadYXe2tOj", text: " " },
            },
          },
          3: {
            cells: {
              0: { style: 1 },
              1: { style: 1 },
              2: { virtual: "JhtSPmXlov0deCvi", style: 3, text: "0" },
              3: { virtual: "JhtSPmXlov0deCvi", style: 3, text: "489" },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
            },
          },
          4: {
            cells: {
              2: { virtual: "JhtSPmXlov0deCvi", style: 3, text: "1" },
              3: { virtual: "JhtSPmXlov0deCvi", style: 3, text: "125" },
            },
          },
          5: {
            cells: {
              0: { style: 1 },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          6: {
            cells: {
              0: { style: 1 },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          7: {
            cells: {
              0: { style: 1 },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          8: {
            cells: {
              0: { style: 1 },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1, text: "00000000000" },
              9: { virtual: "JhtSPmXlov0deCvi" },
            },
          },
          9: {
            cells: {
              0: { style: 1 },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          10: {
            cells: {
              0: { style: 1 },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          11: {
            cells: {
              0: { style: 2, text: "" },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
              10: { virtual: "JhtSPmXlov0deCvi", text: " " },
              12: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          12: {
            cells: {
              0: { style: 2, text: "" },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
              10: { virtual: "JhtSPmXlov0deCvi", text: " " },
              12: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          13: {
            cells: {
              0: { style: 2, text: "" },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
              10: { virtual: "JhtSPmXlov0deCvi", text: " " },
              12: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          14: {
            cells: {
              0: { style: 2, text: "" },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
              10: { virtual: "JhtSPmXlov0deCvi", text: " " },
              12: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          15: {
            cells: {
              0: { style: 2, text: "" },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
              10: { virtual: "JhtSPmXlov0deCvi", text: " " },
              12: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          16: {
            cells: {
              0: { style: 2, text: "" },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
              10: { virtual: "JhtSPmXlov0deCvi", text: " " },
              12: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          17: {
            cells: {
              0: { style: 2, text: "" },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
              10: { virtual: "JhtSPmXlov0deCvi", text: " " },
              12: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          18: {
            cells: {
              0: { style: 2, text: "" },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
              10: { virtual: "JhtSPmXlov0deCvi", text: " " },
              12: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          19: {
            cells: {
              0: { style: 2, text: "" },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
              10: { virtual: "JhtSPmXlov0deCvi", text: " " },
              12: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          20: {
            cells: {
              0: { style: 2, text: "" },
              1: { style: 1 },
              2: { style: 1 },
              3: { style: 1 },
              4: { style: 1 },
              5: { style: 1 },
              6: { style: 1 },
              7: { style: 1 },
              8: { style: 1 },
              9: { virtual: "JhtSPmXlov0deCvi", text: " " },
              10: { virtual: "JhtSPmXlov0deCvi", text: " " },
              12: { virtual: "JhtSPmXlov0deCvi", text: " " },
            },
          },
          22: {
            cells: { 10: { virtual: "JhtSPmXlov0deCvi", text: " " } },
          },
          24: { cells: { 10: { text: "0" } } },
          25: { cells: { 10: { text: "1" } } },
          31: { cells: { 10: { text: "489" } } },
          32: { cells: { 10: { text: "125" } } },
        },
        freeze: "A1",
        background: "",
        name: "sheet1",
        autofilter: {},
        styles: [
          {
            border: {
              bottom: ["thin", "#000"],
              right: ["thin", "#000"],
              top: ["thin", "#000"],
              left: ["thin", "#000"],
            },
          },
          {},
          { align: "center" },
          {
            border: {
              bottom: ["thin", "#000"],
              right: ["thin", "#000"],
              top: ["thin", "#000"],
              left: ["thin", "#000"],
            },
            align: "center",
          },
        ],
        validations: [],
        cols: { len: 9 },
        merges: [],
        charts: [
          {
            row: 0,
            col: 0,
            width: 600,
            height: 400,
            config:
              '{"yAxis":{"axisLabel":{"textStyle":{"color":"#333","fontSize":12}},"axisLine":{"lineStyle":{"color":"#333"}},"show":true,"name":"销量","splitLine":{"lineStyle":{"color":"red","width":1,"type":"solid"},"show":false}},"xAxis":{"axisLabel":{"rotate":0,"interval":0,"textStyle":{"color":"#333","fontSize":12}},"data":["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"],"axisLine":{"lineStyle":{"color":"#333"}},"show":true,"name":"服饰","splitLine":{"lineStyle":{"color":"red","width":1,"type":"solid"},"show":false}},"grid":{"top":60,"left":60,"bottom":60,"right":60},"series":[{"barWidth":50,"data":[5,20,36,10,10,20],"name":"销量","itemStyle":{"color":"#c43632","barBorderRadius":0},"label":{"show":true,"position":"top","textStyle":{"color":"black","fontSize":16,"fontWeight":"bolder"}},"type":"bar","barMinHeight":2}],"tooltip":{"formatter":"{b} : {c}","show":true,"textStyle":{"color":"#fff","fontSize":18}},"title":{"padding":[5,20,5,20],"top":"5","left":"left","show":true,"text":"某站点用户访问来源","textStyle":{"color":"#c23531","fontSize":18,"fontWeight":"bolder"}}}',
            url: "",
            extData: "",
            layer_id: "pnx6Zw39t3GrjYJE",
            offsetX: 0,
            offsetY: 0,
            virtualCellRange: [
              [0, 0],
              [0, 1],
              [0, 2],
              [0, 3],
              [0, 4],
              [0, 5],
            ],
          },
        ],
      },
    ];
    function createProxy(id) {
      const rows10 = {
        len: 1000,
      };
      for (let i = 0; i < 1000; i += 1) {
        rows10[i] = {
          cells: {
            0: {
              text: "A-" + i,
            },
            1: {
              text: "B-" + i,
            },
            2: {
              text: "C-" + i,
            },
            3: {
              text: "D-" + i,
            },
            4: {
              text: "E-" + i,
            },
            5: {
              text: "F-" + i,
            },
          },
        };
      }
      const rows = {
        len: 80,
        1: {
          cells: {
            0: {
              text: "testingtesttestetst",
            },
            2: {
              text: "testing",
            },
          },
        },
        2: {
          cells: {
            0: {
              text: "render",
              style: 0,
            },
            1: {
              text: "Hello",
            },
            2: {
              text: "haha",
              merge: [1, 1],
            },
          },
        },
        8: {
          cells: {
            8: {
              text: "border test",
              style: 0,
            },
          },
        },
      };
      const container = document.getElementById(id);
      let xs = x_spreadsheet("#" + id, {
        // mode: 'read',
        view: {
          height: () => container.clientHeight,
          width: () => container.clientWidth,
        },
        showPrintbar: false,
        showToolbar: true,
        // showGrid: false
      })
        .loadData(SHEET_DATA)
        .change((cdata) => {
          // console.log(cdata);
          console.log(">>>", xs.getData());
        })
        .onSave(function (datas) {
          console.info("onSave", datas);
        })
        .onAddChart(function () {
          xs.addChart({
            title: {
              show: true,
              text: "某站点用户访问来源",
              left: "left",
              padding: [5, 20, 5, 20],
              textStyle: {
                fontSize: 18,
                fontWeight: "bolder",
                color: "#c23531",
              },
            },
            legend: {
              show: true,
              data: ["销量"],
              top: "top",
              left: "center",
              orient: "horizontal",
              padding: [25, 20, 25, 10],
              textStyle: {
                color: "#333",
                fontSize: 12,
              },
            },
            grid: {
              left: 60,
              top: 60,
              right: 60,
              bottom: 60,
            },
            tooltip: {
              show: true,
              textStyle: {
                color: "#fff",
                fontSize: 18,
              },
            },
            xAxis: {
              show: true,
              name: "服饰",
              splitLine: {
                show: false,
                lineStyle: {
                  color: "red",
                  width: 1,
                  type: "solid",
                },
              },
              axisLabel: {
                interval: 0,
                rotate: 0,
                textStyle: {
                  fontSize: 12,
                  color: "#333",
                },
              },
              axisLine: {
                lineStyle: {
                  color: "#333",
                },
              },
              data: ["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子"],
            },
            yAxis: {
              show: true,
              name: "销量",
              splitLine: {
                show: false,
                lineStyle: {
                  color: "red",
                  width: 1,
                  type: "solid",
                },
              },
              axisLabel: {
                textStyle: {
                  fontSize: 12,
                  color: "#333",
                },
              },
              axisLine: {
                lineStyle: {
                  color: "#333",
                },
              },
            },
            series: [
              {
                name: "销量",
                type: "bar",
                data: [5, 20, 36, 10, 10, 20],
                barWidth: 50,
                barMinHeight: 2,
                itemStyle: {
                  normal: {
                    barBorderRadius: 0,
                    color: "#c43632",
                    label: {
                      show: true,
                      position: "top",
                      textStyle: {
                        color: "black",
                        fontSize: 16,
                        fontWeight: "bolder",
                      },
                    },
                  },
                },
              },
            ],
          });
          console.info("=============================onAddChart");
        })
        .onPreview(function () {
          window.location.href = "https://www.baidu.com";
        });
      xs.on("cell-drag-stop", (ri, ci) => {
        xs.cellText(ri, ci, "aaaa").reRender();
      });
    }
    function load() {
      // x_spreadsheet.locale('zh-cn');
      createProxy("x-spreadsheet-demo1");
    }
  </script>
</html>
